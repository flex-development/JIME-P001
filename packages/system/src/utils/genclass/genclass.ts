import { Primitive } from '@flex-development/json'
import { GridBreakpointKey } from '@system/types'
import { isBoolean, isNumber, isString } from 'lodash'
import { breakpointInfix } from '../breakpointInfix'

/**
 * @file Implementation - genclass
 * @module utils/genclass/impl
 */

/**
 * Generates a CSS class name.
 *
 * Responsive variations can be generated by supplying a grid
 * {@param breakpoint} key other than "xs". Consult the Sass `$utilities` map
 * for a list of utility class prefixes and values.
 *
 * @param prefix - Class prefix from Sass `$utilities` map
 * @param value - Breakpoint class value, e.g 5 or 'wrap'
 * @param breakpoint - Grid breakpoint key, xs | sm | md | lg | xl | xxl
 */
const genclass = (
  prefix: string,
  value?: Primitive | null,
  breakpoint: GridBreakpointKey = 'xs'
): string => {
  // If false, null, or undefined, return empty string
  if (!value && value !== 0) return ''

  let classes = ''
  let append = ''

  if (isNumber(value) || isString(value)) append = `-${value}`

  if (append !== '-' || (isBoolean(value) && value)) {
    classes = `${breakpointInfix(breakpoint)}${prefix}${append}`
  } else if (append === '-') {
    classes = `${breakpointInfix(breakpoint)}${prefix}`
  }

  return classes.trim()
}

export default genclass
